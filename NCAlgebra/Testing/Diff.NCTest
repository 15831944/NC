(* :Title: 	Diff.NCTest // Mathematica 1.2 and 2.0 *)

(* :Author: 	Unknown. Revised by Mark Stankus (mstankus). *)

(* :Summary:    TEST FILE.  *)

(* :History: 
   :8/1/92		Blocked. (dhurst)
   :9/6/99      Block->Module  (dell)
*)

Module[ 
   {k,x,y,h,A,GE,B1,C1,C2,W,b,D21,temp},

   k = 1;

  SetNonCommutative[x,y,h];

   Quiet[

     NCTest[DirectionalD[x^9 + 123 x^8,x,h], 9 x^8 h + 123 8 x^7 h, 
            "Diff", k++];
     NCTest[DirectionalD[x**y**x,x,h], h**y**x + x**y**h, "Diff", k++];
     NCTest[DirectionalD[x**y**x,y,h], x**h**x, "Diff", k++];
     NCTest[ExpandNonCommutativeMultiply[DirectionalD[x**x**Sin[x],x,h]],
            h**x**Sin[x] + x**h**Sin[x] + x**x**(h Cos[x]), "Diff", k++];
     NCTest[DirectionalD[x,y,h], 0, "Diff", k++]; 

     SetNonCommutative[A,GE,B1,C1,C2,D21,W];

     (* was GradPoly *)
     temp = 2 GE[x] **A[x] - tp[W]**W + tp[C1[x]]**C1[x] +
            2 GE[x]**b**C2[x] + 2 GE[x]**B1[x]**W + GE[x]**b**D21[x]**W;
     NCTest[NCGrad[temp,W], 
            tp[2 GE[x]**B1[x] + GE[x]**b**D21[x] - 2tp[W]], "Diff", k++];

     , NCGrad::limited
  ];

];
