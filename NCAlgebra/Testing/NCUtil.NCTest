<< NCUtil`

Block[
  {k,test,expr,a,b,c,d,x,y,z},

  SetCommutative[a,b,c,d];
  SetNonCommutative[x,y,z];

  (* NCConsistentQ *)

  expr = 0;
  NCTest[NCConsistentQ[expr], True];

  expr = 1;
  NCTest[NCConsistentQ[expr], True];

  expr = Sqrt[2];
  NCTest[NCConsistentQ[expr], True];

  expr = a + b c;
  NCTest[NCConsistentQ[expr], True];

  expr = x;
  NCTest[NCConsistentQ[expr], True];

  expr = x ** x;
  NCTest[NCConsistentQ[expr], True];

  expr = x ** x ** y;
  NCTest[NCConsistentQ[expr], True];

  expr = x ** x ** y + y ** x;
  NCTest[NCConsistentQ[expr], True];

  expr = x ** x ** y + y ** x ** inv[z];
  NCTest[NCConsistentQ[expr], True];

  expr = 2 x;
  NCTest[NCConsistentQ[expr], True];

  expr = 2 x ** x;
  NCTest[NCConsistentQ[expr], True];

  expr = 2 x ** x ** y;
  NCTest[NCConsistentQ[expr], True];

  expr = 2 x ** x ** y + 3 y ** x;
  NCTest[NCConsistentQ[expr], True];

  expr = 2 x ** x ** y + 3 y ** x ** inv[z];
  NCTest[NCConsistentQ[expr], True];

  expr = a x;
  NCTest[NCConsistentQ[expr], True];

  expr = a x ** x;
  NCTest[NCConsistentQ[expr], True];

  expr = a x ** x ** y;
  NCTest[NCConsistentQ[expr], True];

  expr = a x ** x ** y + b y ** x;
  NCTest[NCConsistentQ[expr], True];

  expr = a x ** x ** y + b y ** x ** inv[z];
  NCTest[NCConsistentQ[expr], True];

  expr = Sqrt[a] x ** x ** y + b y ** x ** inv[z];
  NCTest[NCConsistentQ[expr], True];

  expr = x x;
  NCTest[NCConsistentQ[expr], True];

  expr = x y;
  NCTest[NCConsistentQ[expr], False];

  expr = Sqrt[2] x ** x y + 3 y ** x ** inv[z];
  NCTest[NCConsistentQ[expr], False];

  expr = Sqrt[2] x ** x ** y + 3 y x ** inv[z];
  NCTest[NCConsistentQ[expr], False];

  expr = x / y;
  NCTest[NCConsistentQ[expr], False];

  expr = Sqrt[2] x ** x ** y + 3 y ** x / z;
  NCTest[NCConsistentQ[expr], False];

  expr = Sqrt[2] x ** x ** y + 3 x ** inv[x + z ** y];
  NCTest[NCConsistentQ[expr], True];

  expr = Sqrt[2] x ** x ** y + 3 x ** inv[x + x z ** y];
  NCTest[NCConsistentQ[expr], False];

  (* NCGrabSymbols *)
  expr = a aj[x]**y+inv[1+inv[x**tp[y]+b]];
  NCTest[NCGrabSymbols[expr], {a,b,x,y}];
  NCTest[NCGrabSymbols[expr, tp], {tp[y]}];
  NCTest[NCGrabSymbols[expr, tp|aj], {aj[x],tp[y]}];

  NCTest[NCGrabFunctions[expr, tp], {tp[y]}];
  NCTest[NCGrabFunctions[expr, tp|aj], {aj[x],tp[y]}];
  NCTest[NCGrabFunctions[expr, inv], {inv[1+inv[x**tp[y]+b]], 
                                      inv[x**tp[y]+b]}];

];