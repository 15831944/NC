<< NCAlgebra`
<< NCGBX`

Block[
  {a,b,c,d,
  vars,NCExp,PolyExp
  },
  
  (* Test NCAlgebra interface *)

  (* TESTING NCToNCPoly/NCPolyToNC -- BEGIN *)

  Clear[a,b,c];
  SNC[a,b,c];

  vars = {{a},{b,c}};
  NCExp = a;
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, NCPolyMonomial[{0}, {1,2}]];
  NCTest[NCExp, NCExpExp];

  vars = {{a},{b,c}};
  NCExp = 2 b;
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, 2 NCPolyMonomial[{1}, {1,2}]];
  NCTest[NCExp, NCExpExp];

  vars = {{a},{b,c}};
  NCExp = - c;
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, -NCPolyMonomial[{2},{1,2}]];
  NCTest[NCExp, NCExpExp];

  vars = {{a},{b,c}};
  NCExp = b ** a;
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, NCPolyMonomial[{1,0}, {1,2}]];
  NCTest[NCExp, NCExpExp];

  vars = {{a},{b,c}};
  NCExp = 5 c ** b ** a;
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, 5 NCPolyMonomial[{2,1,0},{1,2}]];
  NCTest[NCExp, NCExpExp];

  vars = {{a},{b,c}};
  NCExp = - b ** c ** b ** a;
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, - NCPolyMonomial[{1,2,1,0}, {1,2}]];
  NCTest[NCExp, NCExpExp];

  vars = {{a},{b,c}};
  NCExp = a**a + b**b + c**c;
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, NCPoly[{1,1,1}, {{a,a},{b,b},{c,c}}, vars]];
  NCTest[NCExp, NCExpExp];

  vars = {{a},{b,c}};
  NCExp = a**a -> - b**b - c**c;
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, NCPoly[{1,1,1}, {{a,a},{b,b},{c,c}}, vars]];
  NCTest[(NCExp /. (x_ -> y_) -> x - y), NCExpExp];

  vars = {{a},{b,c}};
  NCExp = a**a == - b**b - c**c;
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, NCPoly[{1,1,1}, {{a,a},{b,b},{c,c}}, vars]];
  NCTest[(NCExp /. (x_ == y_) -> x - y), NCExpExp];

  (* List functionality *)

  NCExp = { - b ** c ** b ** a, a**a + b**b + c**c };
  PolyExp = NCToNCPoly[NCExp, vars];
  NCExpExp = NCPolyToNC[PolyExp, vars];

  NCTest[PolyExp, {NCPoly[{-1}, {{b,c,b,a}}, vars], NCPoly[{1,1,1}, {{a,a},{b,b},{c,c}}, vars]}];
  NCTest[NCExp, NCExpExp];

  (* TESTING NCToNCPoly/NCPolyToNC -- END *)

  (* TESTING SetKnowns/SetUnknowns -- BEGIN *)

  Clear[a,b,c,d];
  SNC[a,b,c,d];

  SetKnowns[a,b];
  SetUnknowns[c,d];
  NCTest[GetMonomialOrder[], {{a,b},{c},{d}}];

  SetKnowns[a,b];
  SetUnknowns[{c,d}];
  NCTest[GetMonomialOrder[], {{a,b},{c,d}}];

  SetKnowns[a,b];
  SetUnknowns[{c},{d}];
  NCTest[GetMonomialOrder[], {{a,b},{c},{d}}];

  SetKnowns[{a},{b}];
  SetUnknowns[{c},{d}];
  NCTest[GetMonomialOrder[], {{a,b},{c},{d}}];

  SetKnowns[b,c];
  NCTest[GetMonomialOrder[], {{b,c}}];

  SetKnowns[{a,b}];
  NCTest[GetMonomialOrder[], {{a,b}}];

  SetKnowns[{{a},{{b}}}];
  NCTest[GetMonomialOrder[], {{a,b}}];

  SetUnknowns[{c,d}];
  NCTest[GetMonomialOrder[], {{a,b},{c,d}}];

  SetUnknowns[d,c];
  NCTest[GetMonomialOrder[], {{a,b},{d},{c}}];

  SetUnknowns[d,{c}];
  NCTest[GetMonomialOrder[], {{a,b},{d},{c}}];

  SetUnknowns[d,{c,b}];
  NCTest[GetMonomialOrder[], {{a,b},{d},{c,b}}];

  ClearMonomialOrder[];
  SetUnknowns[{a,b}];
  NCTest[GetMonomialOrder[], {{a,b}}];

  SetUnknowns[{c,d}];
  NCTest[GetMonomialOrder[], {{c,d}}];

  SetKnowns[a,b];
  SetUnknowns[c,d];
  SetKnowns[c,d];
  SetUnknowns[a,b];
  NCTest[GetMonomialOrder[], {{c,d},{a},{b}}];

  (* TESTING SetKnowns/SetUnknowns -- END *);

  (* TESTING SetMonomialOrder -- BEGIN *)

  SetMonomialOrder[a,b];
  NCTest[GetMonomialOrder[], {{a},{b}}];

  SetMonomialOrder[{a},{b}];
  NCTest[GetMonomialOrder[], {{a},{b}}];

  SetMonomialOrder[{a,b}];
  NCTest[GetMonomialOrder[], {{a,b}}];

  SetMonomialOrder[{a,b},{c,d}];
  NCTest[GetMonomialOrder[], {{a,b},{c,d}}];

  SetMonomialOrder[{a,b},{c}];
  NCTest[GetMonomialOrder[], {{a,b},{c}}];

  SetMonomialOrder[{a,b},c];
  NCTest[GetMonomialOrder[], {{a,b},{c}}];

  (* TESTING SetMonomialOrder -- END *)

  SetMonomialOrder[{a,b},{d},{c,b}];
  NCTest[NCPolyDisplayOrder[GetMonomialOrder[]], 
       "a < b \[LessLess]  d \[LessLess]  c < b"];
  NCTest[PrintMonomialOrder[], 
       "a < b \[LessLess]  d \[LessLess]  c < b"];

  SetMonomialOrder[{a,b},{d},{c,b,e}];
  NCTest[NCPolyDisplayOrder[GetMonomialOrder[]], 
       "a < b \[LessLess]  d \[LessLess]  c < b < e"];
  NCTest[PrintMonomialOrder[], 
       "a < b \[LessLess]  d \[LessLess]  c < b < e"];

];